<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Java的JDBC | xianzheTM's site</title><meta name="author" content="xianzheTM"><meta name="copyright" content="xianzheTM"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="用Java操作数据库.">
<meta property="og:type" content="article">
<meta property="og:title" content="Java的JDBC">
<meta property="og:url" content="http://example.com/2018/08/18/Java%E7%9A%84JDBC/index.html">
<meta property="og:site_name" content="xianzheTM&#39;s site">
<meta property="og:description" content="用Java操作数据库.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2018-08-17T16:39:41.000Z">
<meta property="article:modified_time" content="2024-03-14T12:19:35.147Z">
<meta property="article:author" content="xianzheTM">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2018/08/18/Java%E7%9A%84JDBC/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Java的JDBC',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-14 20:19:35'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="xianzheTM's site"><span class="site-name">xianzheTM's site</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java的JDBC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2018-08-17T16:39:41.000Z" title="发表于 2018-08-18 00:39:41">2018-08-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-14T12:19:35.147Z" title="更新于 2024-03-14 20:19:35">2024-03-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Java的JDBC"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>用Java操作数据库.</p>
<span id="more"></span>

<h1 id="前提工作"><a href="#前提工作" class="headerlink" title="前提工作"></a>前提工作</h1><h2 id="为当前项目添加驱动"><a href="#为当前项目添加驱动" class="headerlink" title="为当前项目添加驱动"></a>为当前项目添加驱动</h2><p>IDEA有内置的数据库工具(貌似ultimate版才有),可以直接在IDEA中像用SSMS,workbench,Navicat等工具一样操作数据库,这个工具也有独立版,叫DataGrip.使用这个工具时,只要注意密码用户名,端口号,而且它会提示下载驱动.</p>
<p><img src="/Java%E7%9A%84JDBC%5C%E5%B7%A5%E5%85%B7.png"></p>
<p>然后把这个下下来的驱动包加入当前项目,File&gt;Project Structure&gt;Dependencies,点加号加进去.</p>
<h2 id="注册驱动-建立连接"><a href="#注册驱动-建立连接" class="headerlink" title="注册驱动,建立连接"></a>注册驱动,建立连接</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="comment">//注意不要导错包  </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//向DriverManager注册驱动</span></span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">  </span><br><span class="line">            <span class="comment">// 建立与数据库的Connection连接</span></span><br><span class="line">            <span class="comment">// 这里需要提供：</span></span><br><span class="line">            <span class="comment">// 数据库所处于的ip:127.0.0.1 (本机)</span></span><br><span class="line">            <span class="comment">// 数据库的端口号： 3306 （mysql专用端口号）</span></span><br><span class="line">            <span class="comment">// 数据库名称 how2java</span></span><br><span class="line">            <span class="comment">// 编码方式 UTF-8</span></span><br><span class="line">            <span class="comment">// 账号 root</span></span><br><span class="line">            <span class="comment">// 密码 admin</span></span><br><span class="line">  </span><br><span class="line">            <span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> DriverManager</span><br><span class="line">                    .getConnection(</span><br><span class="line">                            <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/how2java?useSSL=false&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">  </span><br><span class="line">            System.out.println(<span class="string">&quot;连接成功，获取连接对象： &quot;</span> + c);</span><br><span class="line">  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>useSSL=false</code>这里我没有设置语言,因为我的MySQL默认就是UTF-8,而设置SSL为false是避免等会的警告.</p>
<h1 id="一些SQL的知识"><a href="#一些SQL的知识" class="headerlink" title="一些SQL的知识"></a>一些SQL的知识</h1><h2 id="存储机制"><a href="#存储机制" class="headerlink" title="存储机制"></a>存储机制</h2><p>MySQL数据库通常支持如下两种存储机制。 </p>
<ul>
<li>MylSAM：这是MySQL早期默认的存储机制，对事务支持不够好。</li>
<li>InnoDB：InnoDB提供事务安全的存储机制。InnoDB通过建立行级锁来保证事务完整性，并以Oracle风格的共享锁来处理Select语句。系统默认启动InnoDB存储机制，如果不想使用InnoDB表，则可以使用skip-innodb选项。</li>
</ul>
<p>对比两种存储机制，不难发现InnoDB比MylSAM多了事务支持的功能，而事务支持是Java EE最重要的特性，因此通常推荐使用InnoDB存储机制。如果使用5.0以上版本的MySQL数据库系统，通 常无须指定数据表的存储机制，因为系统默认使用InnoDB存储机制。如果需要在建表时显式指定存储机制，则可在标准建表语法的后面添加下面任意一句。</p>
<p>ENGINE&#x3D;MyISAM—— 强制使用MylSAM存储机制。</p>
<p>ENGFNE&#x3D;InnoDB—— 强制使用InnoDB存储机制。</p>
<h2 id="SQL语句基础"><a href="#SQL语句基础" class="headerlink" title="SQL语句基础"></a>SQL语句基础</h2><p>标准的SQL语句通常可分为如下几种类型。</p>
<ul>
<li>查询语句：主要由select关键字完成，查询语句是SQL语句中最复杂、功能最丰富的语句。</li>
<li>DML （Data Manipulation Language,数据操作语言）语句：主要由 insert、update 和 delete 三个<br>关键字完成。</li>
<li>DDL （Data Definition Language,数据定义语言）语句：主要由 create、alter、drop 和 truncate<br>四个关键字完成。</li>
<li>DCL （Data Control L anguage,数据控制语言）语句：主要由grant和 revoke两个关键字完成。</li>
<li>事务控制语句：主要由commit、rollback和 savepoint三个关键字完成。</li>
</ul>
<p>在 SQL命令中也可能需要使用标识符，标识符可用于定义表名、列名，也可用于定义变量等。这 些标识符的命名规则如下。</p>
<ul>
<li><p>标识符通常必须以字母开头。</p>
</li>
<li><p>标识符包括字母、数字和三个特殊字符（#_$）。</p>
</li>
<li><p>不要使用当前数据库系统的关键字、保留字，通常建议使用多个单词连缀而成，单词之间以_<br>分隔。</p>
</li>
<li><p>同一个模式下的对象不应该同名，这里的模式指的是外模式。</p>
<p>什么是外模式?</p>
<blockquote>
<p><img src="/Java%E7%9A%84JDBC%5C%E6%A8%A1%E5%BC%8F.png"></p>
<p>作者：刘慰</p>
<p>链接：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/38737183/answer/93294527">https://www.zhihu.com/question/38737183/answer/93294527</a></p>
<p>来源：知乎</p>
<p>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
<p>这张图表示数据库管理系统（DBMS）从三个层次来管理数据：外部层次（External Level）、概念层次（Conceptual Level）和内部层次（Internal Level）。其中外部层次的数据是用户所看到的数据，所以又叫『用户』层次；概念层次的数据是DBMS中全局管理（可以简单地理解为所有的）数据，及数据之间的约束，所以又叫『逻辑』层次；内部层次的数据是存储在介质上的数据，包括存储路径、存储方式、索引方式等，所以又叫『物理』层次。</p>
<p>而『模式』，就是『对于数据的结构性描述』，所以对于不同层次的数据，就对应着不同层次的模式，分别是：外模式（用户模式）、模式（概念模式&#x2F;逻辑模式）与内模式（物理模式）。</p>
<p>在一个数据库系统中，『模式』与『内模式』都只能有一个，但『外模式』可以有很多个。原因是『模式』是对DBMS中所有数据的全局性的结构描述，所以只能有一种形式。举个例子：一个学校的数据库中要存放所有学生、课程与选课记录的信息。我们可以用三张表：学生信息表、课程信息表与选课记录表来存放所有的数据。但是存放学生的数据的时候，我们只能够选取某一种特定的结构对学生的信息进行描述，而不能多种不同的结构共存（比如两张不同结构的学生表，存放的都是所有学生的信息）。所以『模式』只能有一个。同样，我们在介质上存放数据的时候，也只能选取某一种特定的存储路径（数据文件在哪个文件夹下）、存储方式（二进制&#x2F;文本）、索引方式（聚簇索引，普通索引）等等，可以理解为一种数据结构，和具体的计算机语言没什么关系，也不能够像程序一样执行。</p>
<p>至于『外模式』，是以『视图』的形式展现给用户的，所以我猜你对于外模式理解错误的原因，就是理解错误了『视图』的概念。这里的『视图』不是我们平时说的 UI ，而是指数据库中的视图，又叫『虚表』，是相对于『基本表』来说的。这里的『基本表』指的就是我们在建立数据库的时候需要创建的那些数据表（用 CREATE TABLE 创建出来的），而视图，是对这些基本表中的数据的某种展现形式，是这些数据的一个子集，但不限于某张表中的数据的子集，也可以是多张表联合起来进行显示的一组数据。比如在一个学校的教务系统中，我们希望每个学生只能够看到自己的成绩，普通老师可以看到他&#x2F;她教的学生的成绩，系主任可以看到这个系中所有学生的成绩，校长可以看到学校中每个学生的成绩。那么我们可以基于所有学生的成绩数据，针对于不同权限的用户选取不同的子集，这个子集就是所谓的『视图』。但需要注意的是，『视图』本身并不『实际』存放数据，而只是对于如何选取数据的一种描述，这也是所谓的『虚』。当全局数据改变的时候，视图中的数据也会随之改变。通过外模式，可以让不同的用户（包括应用程序）看到他们希望看到的（比如可以同时看到学生本人的信息及他&#x2F;她的所有成绩与对应的课程的信息，而这些数据实际上是分别存在于不同的数据表中的），或是我们希望他们看到的数据（通过不同的子集来实现）。</p>
<p>总而言之，三种层次的模式都是对于数据的描述，只不过描述的层次不同。</p>
</blockquote>
</li>
</ul>
<h3 id="DDL语句"><a href="#DDL语句" class="headerlink" title="DDL语句"></a>DDL语句</h3><p>DDL语句是操作数据库对象的语句，包括创建(create),删除(drop)和修改(alter)数据库对象。最基本的数据库对象是数据表，数据表是存储数据的逻辑单元。但数据库里绝不仅包括数据表，数据库里可包含如下表所示的几种常见的数据库对象。</p>
<p><img src="/Java%E7%9A%84JDBC%5CDDL.png"></p>
<p>1.创建表的语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名</span><br><span class="line">(</span><br><span class="line">	columnName datatype,</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>2.修改表的语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--增加列定义</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名</span><br><span class="line"><span class="keyword">add</span></span><br><span class="line">(</span><br><span class="line">	columnName datatype,</span><br><span class="line">    ...</span><br><span class="line">);</span><br><span class="line"><span class="comment">--修改列定义</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名</span><br><span class="line">modify columnName datatype;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">add的必须是原表不存在的,modify的必须是原表存在的</span></span><br><span class="line"><span class="comment">MySQL的modify不支持一次修改多个表,Oracle的可以,只要像add一样用括号将多个字段包起来</span></span><br><span class="line"><span class="comment">MySQL的想要修改多个就要多个modify</span></span><br><span class="line"><span class="comment">modify时注意修改后的字段属性不能和已存在的数据冲突</span></span><br><span class="line"><span class="comment">修改默认值只会修改新增记录的默认值,原来的没有影响</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">--删除列</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名</span><br><span class="line"><span class="keyword">drop</span> columnName;</span><br><span class="line"><span class="comment">--MySQL支持的重命名表</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名</span><br><span class="line">rename <span class="keyword">to</span> 新表名;</span><br><span class="line"><span class="comment">--MySQL支持的重命名列名</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名</span><br><span class="line">change old_column_name new_column_name datatype;</span><br></pre></td></tr></table></figure>

<p>3.删除表的语法</p>
<p><code>drop table 表名</code></p>
<p>4.truncate表</p>
<p><code>truncate 表名</code>可以清空表的数据,但是保留了表的结构.</p>
<p><em>在information_scheme数据库中的tables表保存了数据库实例中的所有数据表,可以查询该表来获取表信息.</em></p>
<h3 id="数据库约束"><a href="#数据库约束" class="headerlink" title="数据库约束"></a>数据库约束</h3><p>大部分数据库支持下面5种完整性约束。</p>
<ul>
<li><p>NOT NULL：非空约束，指定某列不能为空。</p>
</li>
<li><p>UNIQUE：唯一约束，指定某列或者几列组合不能重复。</p>
</li>
<li><p>PRIMARY KEY：主键，指定该列的值可以唯一地标识该条记录。</p>
</li>
<li><p>FOREIGN KEY：外键，指定该行记录从属于主表中的一条记录，主要用于保证参照完整性。</p>
</li>
<li><p>CHECK：检查，指定一个布尔表达式，用于指定对应列的值必须满足该表达式。(MySQL不支持)</p>
<p><em>可以在information_schema数据库的TABLE_CONSTRAINTS表查看约束信息</em></p>
</li>
</ul>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><p>索引通过快速路径访问方法来快速定位数据,加速查询.索引从属于数据表,和数据表一样属于数据库对象,不能独立存在,必须属于某个表.</p>
<p>创建索引有两种方式。</p>
<ul>
<li>自动：当在表上定义主键约束、唯一约束和外键约束时，系统会为该数据列自动创建对应的索<br>引。</li>
<li>手动：用户可以通过create index…语句来创建索引。</li>
</ul>
<p>删除索引也有两种方式。</p>
<ul>
<li>自动：数据表被删除时，该表上的索引自动被删除。</li>
<li>手动：用户可以通过drop index…语句来删除指定数据表上的指定索引。</li>
</ul>
<p>索引的作用类似于书的目录，几乎没有一本书没有目录，因此几乎没有一个表没有索引。一个表中可以有多个索引列，每个索引都可用于加速该列的查询速度。<br>正如书的目录总是根据书的知识点来建立一样,因为读者经常要根据知识点来查阅一本书。类似的，通常为经常需要查询的数据列建立索引，可以在一列或者多列上创建索引。创建索引的语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index index_name</span><br><span class="line"><span class="keyword">on</span> table_name (<span class="keyword">column</span>[,<span class="keyword">column</span>]...);</span><br></pre></td></tr></table></figure>

<p>索引也会带来两点坏处,1.每当数据表发生变化时,数据库系统需要维护索引,因此会有一定开销,2.索引本身也要占地方</p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>视图其实更像是向外展示数据的手段,它是将数据库中的一些数据查询出来给人看.是一个便利的展示数据集的手段.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> 视图名</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">subquery;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> view_test</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> tescher_name,class_name <span class="keyword">from</span> school_table</span><br><span class="line"><span class="keyword">with</span> <span class="keyword">check</span> option;<span class="comment">--强制只读视图数据</span></span><br></pre></td></tr></table></figure>

<h3 id="DML语句"><a href="#DML语句" class="headerlink" title="DML语句"></a>DML语句</h3><p>DML语句由insert into、update 和delete from三个命令组成。</p>
<p>比较简单,略过.</p>
<h3 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h3><p><em>不少内容都在数据库课讲过,下面只简明的提一下</em></p>
<p>1.concat用于将查询出来的结果拼接起来,as用于给结果的列起个别名(或者用空格).对于MySQL来说,如果在算数表达式中使用null,整个表达式结果就是null</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	CONCAT( `name`, hp ) <span class="keyword">AS</span> DATA </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	`jdbctest`</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> teacher_id MY_ID , concat (teacher_name , teacher_id) teacher</span><br></pre></td></tr></table></figure>

<p>也可以给表起别名. </p>
<p>2.like和下划线(一个字符),百分号(任意个字符)实现模糊查询,还有正则模式</p>
<p>3.order by和desc降序排列</p>
<h3 id="数据库函数"><a href="#数据库函数" class="headerlink" title="数据库函数"></a>数据库函数</h3><p>函数被分为单行函数和多行函数，单行函数对每行输入值单独计算，每行得 到一个计算结果返回给用户；多行函数对多行输入值整体计算，最后只会得到一个结果。</p>
<h4 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h4><ul>
<li>单行函数的参数可以是变量、常量或数据列。单行函数可以接收多个参数，但<strong>只返回一个值</strong>。</li>
<li>单行函数会对每行单独起作用，每行(可能包含多个参数)返回一个结果。</li>
<li>使用单行函数可以改变参数的数据类型。单行函数支持嵌套使用，即内层函数的返回值是外层函数的参数。</li>
</ul>
<p>大致分为以下几类:</p>
<ul>
<li>日期时间函数</li>
<li>数值函数</li>
<li>字符函数</li>
<li>转换函数</li>
<li>其他函数<ul>
<li>位函数</li>
<li>流程控制函数</li>
<li>加密解密函数</li>
<li>信息函数</li>
</ul>
</li>
</ul>
<p>一些例子:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--选出teacher_table表中teacher_name列的字符长度</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">char_length</span>(teacher_name) <span class="keyword">from</span> teacher_table;</span><br><span class="line"><span class="comment">--计算teacher_name列的字符长度的sin值</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sin</span>(<span class="keyword">char_length</span>(teacher_name))</span><br><span class="line"><span class="keyword">from</span> teacher_table;</span><br><span class="line"><span class="comment">--计算1.57的Sin值，约等于1</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sin</span>(<span class="number">1.57</span>);</span><br><span class="line"><span class="comment">--为指定日期添加一定的时间</span></span><br><span class="line"><span class="comment">--在这种用法下interval是关键字，需要一个数值，还需要一个单位</span></span><br><span class="line"><span class="keyword">SELECT</span> DATE_ADD(<span class="string">&#x27;1998-01-02&#x27;</span>, <span class="type">interval</span> <span class="number">2</span> <span class="keyword">MONTH</span>);</span><br><span class="line"><span class="comment">--这种用法更简单</span></span><br><span class="line"><span class="keyword">select</span> ADDDATE(<span class="string">&#x27;1998-01-02&#x27;</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">--获取当前日期</span></span><br><span class="line"><span class="keyword">select</span> CURDATE();</span><br><span class="line"><span class="comment">--获取当前时间</span></span><br><span class="line"><span class="keyword">select</span> curtime();</span><br><span class="line"><span class="comment">--下面的MD5是MD5加密函数</span></span><br><span class="line"><span class="keyword">select</span> MD5(<span class="string">&#x27;testing&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>SQL提供了如下几个处理null的函数。</p>
<ul>
<li>ifnull(exprl，expr2 ):如果exprl为null,则返回expr2, 否则返回exprl。</li>
<li>nullif(exprl，expr2):如果erprl和expr2相等，则返回null，否则返回exprl。</li>
<li>if(exprl,expr2,expr3)：有点类似于？:三目运算符，如果exprl为true ,不等于0，且不等于null, 则返回expr2, 否则返回expr3。</li>
<li>isnull(exprl)：判断exprl是否为null,如果为null则返回true ,否则返回false。</li>
</ul>
<p>另一个case函数:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="keyword">value</span> </span><br><span class="line"><span class="keyword">when</span> compare_valuel <span class="keyword">then</span> resultl </span><br><span class="line"><span class="keyword">when</span> compare_value2 <span class="keyword">then</span> result2</span><br><span class="line">...</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">result</span> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>case函数用value和后面的compare_valuel、compare_value2、…依次进行比较，如果value和指定的 compare valuel相等，则返回对应的result1, 否则返回else后的result。例如如下SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student_name , <span class="keyword">case</span> java_teacher </span><br><span class="line"><span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">&#x27;Java 老师&#x27;</span> </span><br><span class="line"><span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span> <span class="string">&#x27;Ruby 老师&#x27;</span> </span><br><span class="line"><span class="keyword">else</span> <span class="string">&#x27;其他老师’</span></span><br><span class="line"><span class="string">end from student_table;</span></span><br></pre></td></tr></table></figure>

<p>在第二种用法中，condition1, condition2都是一个返回boolean值的条件表达式，因此这种用法更<br>加灵活。例如如下SQL语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span>,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line">	<span class="keyword">WHEN</span> hp <span class="operator">&lt;</span> <span class="number">410</span> <span class="keyword">THEN</span></span><br><span class="line">	<span class="string">&#x27;low_hp&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;high_hp&#x27;</span> </span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> LEVEL </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	`jdbctest`;</span><br></pre></td></tr></table></figure>

<h4 id="分组和组函数-多行函数"><a href="#分组和组函数-多行函数" class="headerlink" title="分组和组函数(多行函数)"></a>分组和组函数(多行函数)</h4><p>组函数也就是前面提到的多行函数，组函数将一组记录作为整体计算，每组记录返回一个结果，而 不是每条记录返回一个结果.常用的组函数有如下5个。</p>
<ul>
<li><p>avg([distinct|all]expr)：计算多行expr的平均值，其中，expr可以是变量、常量或数据列，但其<br>数据类型必须是数值型。还可以在变量、列前使用distinct或 all关键字，如果使用distinct,则表明不计算重复值；all用和不用的效果完全一样，表明需要计算重复值.</p>
</li>
<li><p>count({ *|[distinct|all]expr})：计算多行expr的总条数，其中，expr可以是变量、常量或数据列，<br>其数据类型可以是任意类型；用星号(*)表示统计该表内的记录行数；distinct表示不计算重复值。</p>
</li>
<li><p>max(expr)：计算多行expr的最大值，其中expr可以是变量、常量或数据列，其数据类型可以 是任意类型。</p>
</li>
<li><p>min(expr)：计算多行expr的最小值，其中expr可以是变量、常量或数据列，其数据类型可以是 任意类型。</p>
</li>
<li><p>sum([distinct|all]expr): 计算多行expr的总和，其中，expr可以是变量、常量或数据列，但其数据类型必须是数值型；distinct表示不计算重复值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">	<span class="built_in">avg</span>( ifnull( info, <span class="number">0</span> ))<span class="comment">--mysql中null会导致表达式结果为null</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">	jdbctest</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">	id<span class="operator">&lt;</span><span class="number">6</span>;</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">	hp,<span class="built_in">count</span>(<span class="operator">*</span>)<span class="comment">--查询hp字段,统计出表格的行数,按照hp分组,且升序排列</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">	jdbctest</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">	hp <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>

<p>对分组的结果进行过滤:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">	hp,</span><br><span class="line">	<span class="built_in">count</span>( hp )</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">	jdbctest</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">	hp <span class="keyword">asc</span></span><br><span class="line"><span class="keyword">having</span></span><br><span class="line">	<span class="built_in">count</span>( hp )<span class="operator">&gt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="多表连接查询"><a href="#多表连接查询" class="headerlink" title="多表连接查询"></a>多表连接查询</h4><p>需要选择的数据并不是来自一个表，而是来自多个数据表，这就需要使用多表连接查询。</p>
<p>多表连接查询有两种规范，较早的SQL92规范支持如下几种多表连接查询。</p>
<ul>
<li>等值连接。</li>
<li>非等值连接。</li>
<li>外连接。</li>
<li>广义笛卡儿积。</li>
</ul>
<p>SQL99规范提供了可读性更好的多表连接语法，并提供了更多类型的连接查询。SQL99支持如下几种多表连接查询。</p>
<ul>
<li>交叉连接。</li>
<li>自然连接。</li>
<li>使用using子句的连接。</li>
<li>使用on子句的连接。</li>
<li>全外连接或者左、右外连接。</li>
</ul>
<ol>
<li>SQL92的连接查询<br>  SQL92的多表连接语法比较简洁，这种语法把多个数据表都放在from之后，多个表之间以逗号隔 开；连接条件放在where之后，与查询条件之间用and逻辑运算符连接。如果连接条件要求两列值相等， 则称为等值连接，否则称为非等值连接；如果没有任何连接条件，则称为广义笛卡儿积。</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">	jdbctest.<span class="operator">*</span>,</span><br><span class="line">	jdbctest1.name</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">	jdbctest,</span><br><span class="line">	jdbctest1</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">	jdbctest.id <span class="operator">=</span> jdbctest1.id;</span><br></pre></td></tr></table></figure>

<p>  大致的流程是:</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> t in jdbctest</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> s in jdbctest1</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">if</span> (jdbctest.id = jdbctest1.id)</span><br><span class="line">    	sout s+t</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  如果没有where后面的条件,得到的就是广义笛卡尔积.</p>
<ol start="2">
<li><p>SQL99的连接查询</p>
<p>交叉连接(cross join )：交叉连接效果就是SQL92中的广义笛卡儿积，所以交叉连接无须任何连接条件.</p>
<p>自然连接(natural join ) : 自然连接表面上看起来也无须指定连接条件，但自然连接是有连接条件的，自然连接会以两个表中的同名列作为连接条件；如果两个表中没有同名列，则自然连接与交叉连接效果完全一样—因为没有连接条件。</p>
<p>using子句连接：using子句可以指定一列或多列，用于显式指定两个表中的同名列作为连接条件。假设两个表中有超过一列的同名列，如果使用natural join ,则会把所有的同名列当成连接条件；使用using子句，就可显式指定使用哪些同名列作为连接条件。</p>
<p>on子句连接：这是最常用的连接方式，SQL 99语法的连接条件放在on子句中指定，而且每个 on子句只指定一个连接条件。这意味着：如果需要进行N表连接，则需要有N-1个join…on对。</p>
<p>剩下的左外连接,右外连接,全连接</p>
<ul>
<li><p>LEFT JOIN关键字会从左表那里返回所有的行，即使在右表中没有匹配的行。</p>
</li>
<li><p>RIGHT JOIN 关键字会右表那里返回所有的行，即使在左表中没有匹配的行。</p>
</li>
<li><p>只要其中某个表存在匹配，FULL JOIN 关键字就会返回行。</p>
</li>
</ul>
</li>
</ol>
<h4 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h4><p>子查询就是指在查询语句中嵌套另一个査询，子查询可以支持多层嵌套。对于一个普通的查询语句而言，子查询可以出现在两个位置。</p>
<ul>
<li>出现在from语句后当成数据表，这种用法也被称为行内视图，因为该子查询的实质就是一个临时视图。</li>
<li>出现在where条件后作为过滤条件的值。</li>
</ul>
<h3 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h3><p>select语句查询的结果是一个包含多条数据的结果集，类似于数学里的集合，可以进行交(intersect)、 并 (union)和差 (minus)运算，select查询得到的结果集也可能需要进行这三种运算。 为了对两个结果集进行集合运算，这两个结果集必须满足如下条件。</p>
<ul>
<li>两个结果集所包含的数据列的数量必须相等。</li>
<li>两个结果集所包含的数据列的数据类型也必须一一对应</li>
</ul>
<p>实际上MySQL只支持union运算,其他两种都只能用子查询或多表连接的方式实现.</p>
<h1 id="创建语句"><a href="#创建语句" class="headerlink" title="创建语句"></a>创建语句</h1><p>在连接后创建相应的SQL语句:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> c.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into jdbctest values(2,&#x27;ye&#x27;,15,&#x27;C1&#x27;)&quot;</span>;</span><br><span class="line">s.execute(sql);</span><br></pre></td></tr></table></figure>

<h1 id="关闭连接"><a href="#关闭连接" class="headerlink" title="关闭连接"></a>关闭连接</h1><p>数据库的连接是有限资源，相关操作结束后，养成关闭数据库的好习惯</p>
<p>先关闭Statement</p>
<p>后关闭Connection </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">            c = DriverManager</span><br><span class="line">                    .getConnection(</span><br><span class="line">                            <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/dailytest?useSSL=false&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;root&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 注意：使用的是 java.sql.Statement</span></span><br><span class="line">            <span class="comment">// 不要不小心使用到： com.mysql.jdbc.Statement;</span></span><br><span class="line">            s = c.createStatement();</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into jdbctest values(2,&#x27;ye&#x27;,15,&#x27;C1&#x27;)&quot;</span>;</span><br><span class="line">            s.execute(sql);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (s != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    s.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (c != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    c.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者用try(){}风格:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> DriverManager</span><br><span class="line">                .getConnection(</span><br><span class="line">                        <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/dailytest?useSSL=false&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;root&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line">             <span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> c.createStatement();) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into jdbctest values(2,&#x27;ye&#x27;,15,&#x27;C1&#x27;)&quot;</span>;</span><br><span class="line">            s.execute(sql);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><p>向DailyTest数据库的JDBCtest表插入一百个hero记录.</p>
<p><code>truncate table dailytest.jdbctest</code>使用这条命令可以清空jdbctest表的数据,便于测试.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> DriverManager</span><br><span class="line">                .getConnection(</span><br><span class="line">                        <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/dailytest?useSSL=false&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;root&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line">             <span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> c.createStatement()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">maxh</span> <span class="operator">=</span> <span class="number">450</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">minh</span> <span class="operator">=</span> <span class="number">350</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">maxd</span> <span class="operator">=</span> <span class="number">80</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">mind</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;英雄&quot;</span> + i;</span><br><span class="line">                <span class="type">int</span> <span class="variable">hp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(maxh) % (maxh - minh + <span class="number">1</span>) + minh;</span><br><span class="line">                <span class="type">int</span> <span class="variable">damage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(maxd) % (maxd - mind + <span class="number">1</span>) + minh;</span><br><span class="line">                s.execute(<span class="string">&quot;insert into jdbctest values(null,&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;,&#x27;&quot;</span> + hp + <span class="string">&quot;&#x27;,&#x27;&quot;</span> + damage + <span class="string">&quot;&#x27;)&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意:在SQL语句中使用Java变量要这样写:<code>&#39;&quot; + name + &quot;&#39;</code>.</p>
<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p>查询不能使用Statement的execute方法,因为查询需要返回查询的结果.使用Statement的executeQuery方法,将结果返回给一个ResultSet对象.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> YL</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestRetrieve</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> DriverManager</span><br><span class="line">                .getConnection(</span><br><span class="line">                        <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/dailytest?useSSL=false&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;root&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line">             <span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> c.createStatement()) &#123;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> s.executeQuery(<span class="string">&quot;select * from jdbctest where hp regexp &#x27;.[345].&#x27;&quot;</span>);</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;ID&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="number">2</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">hp</span> <span class="operator">=</span> rs.getInt(<span class="number">3</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">damage</span> <span class="operator">=</span> rs.getInt(<span class="number">4</span>);</span><br><span class="line">                System.out.printf(<span class="string">&quot;%d\t%s\t%d\t%d%n&quot;</span>, id, name, hp, damage);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;exit&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>&quot;select * from jdbctest where hp regexp &#39;.[345].&#39;&quot;</code>,这里我是用了MySQL的正则模式,表示查出hp为三位数,且中间数字是3,4,5的字段的全部信息.</p>
<p><strong>注意</strong>:这里<code>rs.getXxx</code>是从1开始算的.</p>
<h3 id="判断密码是否正确"><a href="#判断密码是否正确" class="headerlink" title="判断密码是否正确"></a>判断密码是否正确</h3><p>判断密码问题应该是在某张表中找是否有符合的记录,而不是将数据读出来比较.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> DriverManager</span><br><span class="line">                .getConnection(</span><br><span class="line">                        <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/dailytest?useSSL=false&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;root&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line">             <span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> c.createStatement()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;password&quot;</span>;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> s.executeQuery(<span class="string">&quot;select * from jdbctest1 where name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;and password=&#x27;&quot;</span> + password + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;right&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="使用预编译语句"><a href="#使用预编译语句" class="headerlink" title="使用预编译语句"></a>使用预编译语句</h1><p>当遇到有些需要重复使用某些结构相同的查询语句时,重复的编译会浪费大量时间,因此可以使用PreparedStatement,具体后面解释.PreparedStatement还有其他优势.</p>
<ul>
<li><p>避免了字符串的拼接</p>
<p>在前面的例子中我们可以看出,写SQL语句有个非常大的问题就是各种双引号,单引号套在一起很容易出错.而PreparedStatement可以使用占位符来替换.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String sql=<span class="string">&quot;insert into hero values(null,?,?,?)&quot;</span>;</span><br><span class="line"><span class="keyword">try</span>(Connection c=...</span><br><span class="line">   PreparedStatement ps=c.prepareStatement(sql))&#123;</span><br><span class="line">    ps.setInt(<span class="number">1</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">    ps.setString(<span class="number">2</span>,<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    ps.execute();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这里设置参数是从1开始计算的,如果第一个字段是自增长的ID则不算做第一个,我这就是如此,那个null表示自增长ID</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
<li><p>性能优势</p>
<p>在前面的例子中:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">maxh</span> <span class="operator">=</span> <span class="number">450</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">minh</span> <span class="operator">=</span> <span class="number">350</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">maxd</span> <span class="operator">=</span> <span class="number">80</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">mind</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;英雄&quot;</span> + i;</span><br><span class="line">                <span class="type">int</span> <span class="variable">hp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(maxh) % (maxh - minh + <span class="number">1</span>) + minh;</span><br><span class="line">                <span class="type">int</span> <span class="variable">damage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(maxd) % (maxd - mind + <span class="number">1</span>) + minh;</span><br><span class="line">                s.execute(<span class="string">&quot;insert into jdbctest values(null,&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;,&#x27;&quot;</span> + hp + <span class="string">&quot;&#x27;,&#x27;&quot;</span> + damage + <span class="string">&quot;&#x27;)&quot;</span>);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>同样结构的语句每次都要编译处理一次,如果使用预编译语句,则在固定部分只要编译一次,每次只要将参数传给数据库,无需编译,网络传输量也更小.</p>
</li>
<li><p>防止SQL注入式攻击</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        String name;</span><br><span class="line">        String password;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        name = scanner.nextLine();</span><br><span class="line">        password = scanner.nextLine();</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">c</span> <span class="operator">=</span> DriverManager</span><br><span class="line">                .getConnection(</span><br><span class="line">                        <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/dailytest?useSSL=false&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;root&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line">             <span class="type">Statement</span> <span class="variable">s</span> <span class="operator">=</span> c.createStatement()) &#123;</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> s.executeQuery(<span class="string">&quot;select * from jdbctest1 where name=&#x27;&quot;</span> + name + <span class="string">&quot;&#x27;and password=&#x27;&quot;</span> + password + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;right&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中,如果我输入<code>&#39;or true or&#39;</code>,SQL语句拼接后就是<code>select * from jdbctest1 where name=&#39;&#39; or trur or&#39;&#39; and password=&#39;&#39;</code>,这就是产生了一个必真条件,导致结果为right.</p>
</li>
</ul>
<h1 id="execute与executeUpdate的区别"><a href="#execute与executeUpdate的区别" class="headerlink" title="execute与executeUpdate的区别"></a>execute与executeUpdate的区别</h1><p>同:</p>
<p>execute与executeUpdate的相同点：都可以执行增加，删除，修改</p>
<p>异:</p>
<p> 不同1：<br>execute可以执行查询语句<br>然后通过getResultSet，把结果集取出来<br>executeUpdate不能执行查询语句<br> 不同2:<br>execute返回boolean类型，true表示执行的是查询语句，false表示执行的是insert,delete,update等等<br>executeUpdate返回的是int，表示有多少条数据受到了影响</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">xianzheTM</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2018/08/18/Java%E7%9A%84JDBC/">http://example.com/2018/08/18/Java%E7%9A%84JDBC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">xianzheTM's site</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java/">java</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2018/10/25/%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86-1/" title="网络原理(1)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">网络原理(1)</div></div></a></div><div class="next-post pull-right"><a href="/2018/08/17/Java%E4%B8%AD%E9%9D%99%E6%80%81%E4%BB%A3%E7%A0%81%E5%9D%97%E3%80%81%E6%9E%84%E9%80%A0%E4%BB%A3%E7%A0%81%E5%9D%97%E3%80%81%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E3%80%81%E6%99%AE%E9%80%9A%E4%BB%A3%E7%A0%81%E5%9D%97/" title="Java中静态代码块、构造代码块、构造函数、普通代码块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java中静态代码块、构造代码块、构造函数、普通代码块</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2018/06/21/AWT%E4%BD%BF%E7%94%A8/" title="AWT使用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-21</div><div class="title">AWT使用</div></div></a></div><div><a href="/2018/07/26/AWT%E8%8F%9C%E5%8D%95/" title="AWT菜单"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-07-26</div><div class="title">AWT菜单</div></div></a></div><div><a href="/2018/08/13/JVM%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E5%88%92%E5%88%86/" title="JVM内存区域划分"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-13</div><div class="title">JVM内存区域划分</div></div></a></div><div><a href="/2018/08/17/Java%E4%B8%AD%E9%9D%99%E6%80%81%E4%BB%A3%E7%A0%81%E5%9D%97%E3%80%81%E6%9E%84%E9%80%A0%E4%BB%A3%E7%A0%81%E5%9D%97%E3%80%81%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E3%80%81%E6%99%AE%E9%80%9A%E4%BB%A3%E7%A0%81%E5%9D%97/" title="Java中静态代码块、构造代码块、构造函数、普通代码块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-17</div><div class="title">Java中静态代码块、构造代码块、构造函数、普通代码块</div></div></a></div><div><a href="/2018/08/13/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="Java多线程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-13</div><div class="title">Java多线程</div></div></a></div><div><a href="/2018/08/11/Java%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8/" title="Java方法引用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-11</div><div class="title">Java方法引用</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">xianzheTM</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xianzheTM"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E6%8F%90%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">前提工作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E6%B7%BB%E5%8A%A0%E9%A9%B1%E5%8A%A8"><span class="toc-number">1.1.</span> <span class="toc-text">为当前项目添加驱动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8-%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.</span> <span class="toc-text">注册驱动,建立连接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9BSQL%E7%9A%84%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">一些SQL的知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">2.1.</span> <span class="toc-text">存储机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E8%AF%AD%E5%8F%A5%E5%9F%BA%E7%A1%80"><span class="toc-number">2.2.</span> <span class="toc-text">SQL语句基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DDL%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.2.1.</span> <span class="toc-text">DDL语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.2.2.</span> <span class="toc-text">数据库约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">2.2.3.</span> <span class="toc-text">索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">2.2.4.</span> <span class="toc-text">视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DML%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.2.5.</span> <span class="toc-text">DML语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.6.</span> <span class="toc-text">单表查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.7.</span> <span class="toc-text">数据库函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.7.1.</span> <span class="toc-text">单行函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%92%8C%E7%BB%84%E5%87%BD%E6%95%B0-%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.7.2.</span> <span class="toc-text">分组和组函数(多行函数)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.7.3.</span> <span class="toc-text">多表连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.7.4.</span> <span class="toc-text">子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="toc-number">2.2.8.</span> <span class="toc-text">集合运算</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.</span> <span class="toc-text">创建语句</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E8%BF%9E%E6%8E%A5"><span class="toc-number">4.</span> <span class="toc-text">关闭连接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">5.</span> <span class="toc-text">练习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.1.</span> <span class="toc-text">查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%AF%86%E7%A0%81%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A1%AE"><span class="toc-number">5.1.1.</span> <span class="toc-text">判断密码是否正确</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%A2%84%E7%BC%96%E8%AF%91%E8%AF%AD%E5%8F%A5"><span class="toc-number">6.</span> <span class="toc-text">使用预编译语句</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#execute%E4%B8%8EexecuteUpdate%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">7.</span> <span class="toc-text">execute与executeUpdate的区别</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2019/03/08/%E7%BA%BF%E6%80%A7%E8%A1%A8/" title="线性表">线性表</a><time datetime="2019-03-08T14:47:00.000Z" title="发表于 2019-03-08 22:47:00">2019-03-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2018/11/03/%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86-2/" title="网络原理(2)">网络原理(2)</a><time datetime="2018-11-03T03:21:34.000Z" title="发表于 2018-11-03 11:21:34">2018-11-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2018/10/26/html%E6%80%BB%E7%BB%93/" title="html总结">html总结</a><time datetime="2018-10-26T13:01:05.000Z" title="发表于 2018-10-26 21:01:05">2018-10-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2018/10/25/%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86-1/" title="网络原理(1)">网络原理(1)</a><time datetime="2018-10-25T13:36:40.000Z" title="发表于 2018-10-25 21:36:40">2018-10-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2018/08/18/Java%E7%9A%84JDBC/" title="Java的JDBC">Java的JDBC</a><time datetime="2018-08-17T16:39:41.000Z" title="发表于 2018-08-18 00:39:41">2018-08-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By xianzheTM</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>